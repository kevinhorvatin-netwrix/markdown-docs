<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Exchange Online Non Owner - Netwrix 1Secure</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../custom.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Exchange Online Non Owner";
        var mkdocs_page_input_path = "Configuration/ExchangeOnlineNonOwner.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> Netwrix 1Secure
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../Whatsnew/">Whatsnew</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Netwrix 1 Secure Documentation</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Configuration</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../ConfigureITInfrastructure/">Configure IT Infrastructure</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">Exchange Online Non Owner</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#grant-permissions-to-the-application">Grant Permissions to the Application</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#grant-required-roles">Grant Required Roles</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#set-up-an-environment">Set Up an Environment</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../NetworkTrafficCompression/">Network Traffic Compression</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Configuration AD</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../AD/GroupPolicyManagementConsole/">Group Policy Management Console</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../AD/ProtocolsAndPorts/">Protocols and Ports</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../AD/DomainAuditPolicies/">Domain Audit Policies</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../AD/SecurityLogSize/">Security Log Size</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../AD/Settings/">Settings</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../AD/ObjectLevel/">Object Level</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../AD/Auto/">Auto</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../AD/CfgManual/">Cfg Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../AD/ADManual/">AD Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../AD/AdvancedPolicy/">Advanced Policy</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../AD/Manual/">Manual</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../AD/ADSI/">ADSI</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../AD/SecondaryLogonService/">Secondary Logon Service</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Configuration Entra ID</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../EntraID/Permissions/">Permissions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../EntraID/RegisterConfig/">Register Config</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Configuration SQL Server</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../SQLServer/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../SQLServer/Permissions/">Permissions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../SQLServer/ConfiguringTraceLogging/">Configuring Trace Logging</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../SQLServer/Ports/">Ports</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Configuration Logon Activity</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../LogonActivity/BasicAuditPolicies/">Basic Audit Policies</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../LogonActivity/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../LogonActivity/SecurityLogSize/">Security Log Size</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../LogonActivity/AdvancedAudit/">Advanced Audit</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../LogonActivity/FirewallRules/">Firewall Rules</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Configuration Computer</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../Computer/ProtocolsAndPorts/">Protocols and Ports</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Computer/RemoteRegistryService/">Remote Registry Service</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Computer/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Computer/LocalPolicy/">Local Policy</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Computer/EventLog/">Event Log</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Computer/ObjectLevel/">Object Level</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Computer/FirewallRules/">Firewall Rules</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Computer/AdvancedPolicy/">Advanced Policy</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../Computer/FileServersandAntivirus/">File Serversand Antivirus</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Install</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Install/InstallAgent/">Install Agent</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Install/">Overview</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Security</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Security/DataSecurity/">Data Security</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Security/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Security/CustomerDataPrivacy/">Customer Data Privacy</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Security/Compliance/">Compliance</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Security/AccessControl/">Access Control</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Integration</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Integration/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Integration/SharePointOnline/">Share Point Online</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Integration/ConnectWise/">Connect Wise</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Service Now</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../Integration/ServiceNow/">Service Now</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Resources/Content/Template1/">Template 1</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Admin</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Admin/UpdateNetwrixCloudAgent/">Update Netwrix Cloud Agent</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Admin/HowItWorks/">How It Works</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Admin/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Admin/Statuses/">Statuses</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Admin/LogIn/">Log in</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Admin/Notifications/">Notifications</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Admin Organizations</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/Organizations/OrganizationGroups/">Organization Groups</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/Organizations/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/Organizations/BillableAccounts/">Billable Accounts</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/Organizations/AddingUsers/">Adding Users</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/Organizations/AddSites/">Add Sites</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/Organizations/ManageMyOrganization/">Manage My Organization</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/Organizations/AddOrganizations/">Add Organizations</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/Organizations/RoleDefinitions/">Role Definitions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/Organizations/ManagingCredentials/">Managing Credentials</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/Organizations/ViewTabsAndDashboard/">View Tabs and Dashboard</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Admin Organizations Sources and Connectors</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../Admin/Organizations/SourcesAndConnectors/">Overview</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Admin/Organizations/SourcesAndConnectors/SharePointOnline/">Share Point Online</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Admin/Organizations/SourcesAndConnectors/EntraID/">Entra ID</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Admin/Organizations/SourcesAndConnectors/ExchangeOnline/">Exchange Online</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Admin/Organizations/SourcesAndConnectors/Computer/">Computer</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Admin/Organizations/SourcesAndConnectors/SQLServer/">SQL Server</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Admin/Organizations/SourcesAndConnectors/ActiveDirectory/">Active Directory</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Admin Data Collection</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/DataCollection/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/DataCollection/SharePointOnline/">Share Point Online</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/DataCollection/EntraID/">Entra ID</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/DataCollection/ExchangeOnline/">Exchange Online</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Admin Data Collection Active Directory</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../Admin/DataCollection/ActiveDirectory/LogOnAsBatch/">Log on as Batch</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Admin/DataCollection/ActiveDirectory/AuditLogging/">Audit Logging</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Admin/DataCollection/ActiveDirectory/PermissionsADContainer/">Permissions AD Container</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Admin/DataCollection/ActiveDirectory/AuditLogsRole/">Audit Logs Role</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Admin/DataCollection/ActiveDirectory/ActiveDirectoryAuditing/">Active Directory Auditing</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Admin/DataCollection/ActiveDirectory/PermissionsRegistryKeys/">Permissions Registry Keys</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Admin/DataCollection/ActiveDirectory/ManageAuditingSecurityLog/">Manage Auditing Security Log</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Admin Data Collection Data Collecting Account</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../Admin/DataCollection/DataCollectingAccount/">Overview</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Admin Data Collection GMSA</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../Admin/DataCollection/GMSA/GMSA/">GMSA</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Admin Data Collection Logon Activity</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../Admin/DataCollection/LogonActivity/">Overview</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Admin/DataCollection/LogonActivity/NonDomainAdmin/">Non Domain Admin</a>
                </li>
    </ul>
                </li>
                <li class="toctree-l2"><a class="reference internal" >Admin Data Collection Computer</a>
    <ul>
                <li class="toctree-l3"><a class="reference internal" href="../../Admin/DataCollection/Computer/">Overview</a>
                </li>
                <li class="toctree-l3"><a class="reference internal" href="../../Admin/DataCollection/Computer/BackupFilesDirectories/">Backup Files Directories</a>
                </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Admin Search and Reports</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/SearchAndReports/ExportReport/">Export Report</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/SearchAndReports/System/">System</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/SearchAndReports/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/SearchAndReports/ApplyFilters/">Apply Filters</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/SearchAndReports/StateInTime/">State in Time</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/SearchAndReports/Compliance/">Compliance</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/SearchAndReports/FilterValues/">Filter Values</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/SearchAndReports/Subscriptions/">Subscriptions</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/SearchAndReports/FilterOperators/">Filter Operators</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/SearchAndReports/AuditLogs/">Audit Logs</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/SearchAndReports/CustomReports/">Custom Reports</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/SearchAndReports/Activity/">Activity</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/SearchAndReports/BillableUsers/">Billable Users</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Admin Alerts</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/Alerts/Alerts/">Alerts</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/Alerts/">Overview</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Admin Dashboard</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/Dashboard/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/Dashboard/AlertsTimeline/">Alerts Timeline</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/Dashboard/OrganizationStatistics/">Organization Statistics</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Admin Risk Profiles</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/RiskProfiles/AddProfile/">Add Profile</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/RiskProfiles/">Overview</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/RiskProfiles/ConfigureProfile/">Configure Profile</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../Admin/RiskProfiles/RiskAssessmentDashboard/">Risk Assessment Dashboard</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Requirements</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../Requirements/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Requirements/PrerequisitesForDataSources/">Prerequisites for Data Sources</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../Requirements/CloudAgentRequirements/">Cloud Agent Requirements</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">Netwrix 1Secure</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Configuration</li>
      <li class="breadcrumb-item active">Exchange Online Non Owner</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="settings-for-non-owner-mailbox-access-audit-using-application">Settings for Non-Owner Mailbox Access Audit: Using Application</h1>
<p>To prepare for non-owner mailbox access auditing in the Exchange Online organization, you will need to take several configuration steps, creating a {{ no such element: dict object['Azure_AD_app'] }} app with the required permissions and instructing this app to automatically apply the necessary audit settings. </p>
<p>These settings shall provide configuration for the All Exchange Online Non-Owner Mailbox Access Events report. See the <a href="../../Admin/SearchAndReports/FilterValues/">Filters</a>  topic for additional information. </p>
<p>To start auditing the data for the report, you need to select the <strong>Collect non-owner mailbox audit data</strong>  check box when adding the Exchange Online source. See the <a href="../../Admin/Organizations/SourcesAndConnectors/ExchangeOnline/">Add an Exchange Online Source and Connectors</a> topic for additional information. Unified audit log must be enabled for a tenant. See the Microsoft <a href="https://learn.microsoft.com/en-us/purview/audit-log-enable-disable?view=o365-worldwide&amp;tabs=microsoft-purview-portal" title="Turn auditing on or off">Turn auditing on or off</a> article for additional information.</p>
<h2 id="grant-permissions-to-the-application">Grant Permissions  to the Application</h2>
<p>Follow the steps to grant permissions to the {{ no such element: dict object['Azure_AD_app'] }} application. @@@NEEDS CONVERSION@@@</p>
<p>In the {{ no such element: dict object['Azure_AD_admin_center'] }}, create and register a {{ no such element: dict object['Azure_AD_app'] }} app. See the </p>
<p>After you created an app, select the newly-created, registered application. If you left the Overview page, it will be listed in the <strong>Identity</strong> &gt; <strong>Applications</strong> &gt; <strong>App registrations</strong> &gt; <strong>All applications</strong> list. 
@@@NEEDSCONVERSION@@@ 
@@@NEEDSCONVERSION@@@</p>
<p>On the Request API permissions blade, click the <strong>APIs my organization uses</strong> tab and search for <em>Office 365 Exchange Online</em>. </p>
<p>Click on the <em>Office 365 Exchange Online</em> entry in the list of apps found.</p>
<p>Proceed with adding the permissions for this app: select <strong>Application permissions</strong> and then select <strong>Exchange.ManageAsApp</strong>. 
@@@NEEDSCONVERSION@@@</p>
<p>The application is granted the required API permissions. </p>
<h2 id="grant-required-roles">Grant Required Roles</h2>
<p>Follow the steps to grant roles to the registered application. 
@@@NEEDS CONVERSION@@@ 
@@@NEEDSCONVERSION@@@ 
@@@NEEDSCONVERSION@@@ 
@@@NEEDSCONVERSION@@@ 
@@@NEEDSCONVERSION@@@</p>
<p>The application is granted the required roles. </p>
<h2 id="set-up-an-environment">Set Up an Environment</h2>
<p>Follow the steps to set up your environment using PowerShell. </p>
<p>Install the Exchange Online PowerShell V2 module.</p>
<p>Make sure you are using the version specified in the <a href="https://docs.microsoft.com/en-us/powershell/exchange/app-only-auth-powershell-v2?view=exchange-ps">related Microsoft article</a>.</p>
<p>Download the PowerShell script for certificate creation, as provided in the <a href="https://docs.microsoft.com/en-us/powershell/exchange/app-only-auth-powershell-v2?view=exchange-ps#step-3-generate-a-self-signed-certificate">Microsoft instruction</a>. </p>
<p>To create a self-signed certificate to be used by the app, run the following command in Powershell:</p>
<pre><code class="language-powershell">Create-SelfSignedCertificate.ps1 -CommonName &quot;MyCompanyName&quot; -StartDate 2020-04-01 -EndDate 2022-04-01
</code></pre>
<p>where:</p>
<ul>
<li><code>CommonName</code> — specify <em>"Netwrix 1Secure"</em></li>
<li><code>StartDate</code> — set to current date</li>
<li><code>EndDate</code> — set to 2 years from now</li>
</ul>
<p>When prompted to specify a password, click <strong>Enter</strong>.</p>
<p>Go to <strong>Identity</strong> &gt; <strong>Applications</strong> &gt; <strong>App registrations</strong> &gt; "your app" &gt;   <strong>Certificates &amp; secrets</strong>. </p>
<p>Click <strong>Upload certificate</strong> and upload the<em>.crt</em> file you have just created.</p>
<p>To create Exchange Online connection session, you can provide certificate file path or thumbprint. If you want to use a file path, run the following command in Powershell:   </p>
<pre><code class="language-PowerShell">Connect-ExchangeOnline -CertificateFilePath &quot;full_path_to_certificate&quot; -AppID &quot;yourAppId&quot; -Organization &quot;Office365_tenant_name&quot;
````

Application (client ID) can be found in the **Overview** page.

 For example:

```powershell
Connect-ExchangeOnline -CertificateFilePath &quot;C:\Path\MyCompanyName1.pfx&quot; -AppId &quot;402b12a2-fb2b-4222-8f54-5596def1&quot; -Organization &quot;myorganization123.onmicrosoft.com&quot;
</code></pre>
<p>You can use certificate thumbprint instead of file path. For that, import the certificate to the local certificate store, using the following command in Powershell:</p>
<pre><code class="language-powershell">Import-PfxCertificate -FilePath &quot;path_to_pfx_certificate&quot; -CertStoreLocation Cert:\CurrentUser\My
</code></pre>
<p>Then run the command in Powershell like following: </p>
<pre><code>    &lt;madcap:codesnippet&gt;
        &lt;madcap:codesnippetbody madcap:uselinenumbers="False" madcap:linenumberstart="1" madcap:continue="False" xml:space="preserve" style="mc-code-lang: PowerShell;"&gt;Connect-ExchangeOnline -CertificateThumbprint 6AEА5A82911ААА3F76FEE149B7B52А70DDFD88 -AppId a14a 822d-f228-412b-9222-281de23 -Organization myorganization123.onmicrosoft.com&lt;/madcap:codesnippetbody&gt;
    &lt;/madcap:codesnippet&gt;
</code></pre>
<p>To set up the audit, run the following command in Powershell: </p>
<pre><code class="language-powershell">Get-ExoMailbox -PropertySets Minimum -RecipientTypeDetails UserMailbox,SharedMailbox,EquipmentMailbox,LinkedMailbox,RoomMailbox | Set-Mailbox -AuditEnabled $true –AuditAdmin Update,Copy,Move,MoveToDeletedItems,SoftDelete,HardDelete,FolderBind,SendAs,SendOnBehalf,Create –AuditDelegate Update,Move,MoveToDeletedItems,SoftDelete,HardDelete,FolderBind,SendAs,SendOnBehalf,Create
</code></pre>
<p>Finally, run the following command in Powershell to end the session:   </p>
<pre><code class="language-PowerShell">Disconnect-ExchangeOnline -Confim:$False
</code></pre>
<p>To automate steps 8-9, you can create a script comprising the corresponding commands and schedule its launch.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../ConfigureITInfrastructure/" class="btn btn-neutral float-left" title="Configure IT Infrastructure"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../NetworkTrafficCompression/" class="btn btn-neutral float-right" title="Network Traffic Compression">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>
  <ul>
    <li>© 2008 - 2025 Netwrix Corporation. All Rights Reserved</li>
    <li class="zDocsFooterLinksList"><a class="css-ettsdk" href="https://www.netwrix.com/privacy.html" target="_blank">Privacy Policy</a></li>
  </ul>

</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../ConfigureITInfrastructure/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../NetworkTrafficCompression/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
